package com.sap.cds.feature.attachments.service;

import java.util.Map;

import com.sap.cds.services.Service;

/**
	* The {@link AttachmentMalwareScanService} is the connection to the malware scan service.
	* It reads the attachment entity, scans the content using the malware scan service
	* and updates the attachment entity with the scan result.
	*/
public interface AttachmentMalwareScanService extends Service {

	/**
		* The {@link AttachmentMalwareScanService} wrapping the malware scan service uses this name
		*/
	String DEFAULT_NAME = "MalwareScanService$Default";

	/**
		* This event is emitted when an attachment shall be scanned for malware
		*/
	String EVENT_SCAN_DOCUMENT = "SCAN_ATTACHMENT";

	/**
		* Scans the given attachment for malware and updates the scan result in the attachment entity
		*
		* @param attachmentEntityName Contains the attachment entity name
		* @param keys                 Contains the keys of the attachment entity
		* @throws com.sap.cds.services.ServiceException Exception to be thrown in case of errors during scanning the document
		*/
	void scanAttachment(String attachmentEntityName, Map<String, Object> keys);

}
